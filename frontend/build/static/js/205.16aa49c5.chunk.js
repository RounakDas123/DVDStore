"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[205],{6205:(e,t,s)=>{s.r(t),s.d(t,{default:()=>R});var i=s(1605),a=s(5043),l=s(423),o=s(9698),r=s(6720),n=s(397),c=s(7950),h=s(3003),d=s(2115),m=s(7752);const u="ConfirmationModal_modal__IxBnh",_="ConfirmationModal_buttonGroup__+IrAP",v="ConfirmationModal_yesButton__iFk0R",p="ConfirmationModal_noButton__Q2L40";var f=s(579);const g=(0,a.forwardRef)(((e,t)=>{let{item:s,userId:i,token:l,onWishlistUpdate:o,actionType:r}=e;const n=(0,a.useRef)(),g=(0,h.wA)();(0,a.useImperativeHandle)(t,(()=>({open(){n.current&&n.current.showModal()},close(){n.current&&n.current.close()}})));const w=()=>{n.current&&n.current.close()},y="cart"===r?"If you add to Cart, it will be removed from Wishlist. Do you wish to proceed?":"Do you wish to delete from Wishlist?";return(0,c.createPortal)((0,f.jsxs)("dialog",{ref:n,className:u,children:[(0,f.jsx)("h2",{children:"Confirmation"}),(0,f.jsx)("p",{children:y}),(0,f.jsxs)("div",{className:_,children:[(0,f.jsx)("button",{className:v,onClick:async()=>{try{if("cart"===r){const e=await fetch(`http://localhost:5000/api/cart/add/${i}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({id:s.id,type:s.type,title:s.title,price:s.price,quantity:1})}),t=await e.json();if(!t.ok&&!t.cart)return void d.oR.error(t.message);d.oR.success(t.message);const a=await fetch(`http://localhost:5000/api/wishlist/delete/${i}/${s.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${l}`}}),o=await a.json();if(!o.ok&&!o.removedItem)return void d.oR.error(o.message);d.oR.success(o.message);let r=0;r=t.cart.movie_tv.reduce(((e,t)=>e+t.quantity),0),localStorage.setItem("cartSize",r),g(m.tV.setInitialValue({type:"cart",value:r})),localStorage.setItem("cart",JSON.stringify(t.cart.movie_tv)),g(m.fo.setInitialValue({type:"cart",value:t.cart.movie_tv})),localStorage.setItem("wishlistSize",o.wishlist.movie_tv.length),g(m.tV.setInitialValue({type:"wishlist",value:o.wishlist.movie_tv.length})),localStorage.setItem("wishlist",JSON.stringify(o.wishlist.movie_tv)),g(m.fo.setInitialValue({type:"wishlist",value:o.wishlist.movie_tv}))}else if("delete"===r){const e=await fetch(`http://localhost:5000/api/wishlist/delete/${i}/${s.id}`,{method:"DELETE",headers:{Authorization:"Bearer "+l}}),t=await e.json();if(!t.ok&&!t.removedItem)return void d.oR.error(t.message);d.oR.success(t.message),localStorage.setItem("wishlistSize",t.wishlist.movie_tv.length),g(m.tV.setInitialValue({type:"wishlist",value:t.wishlist.movie_tv.length})),localStorage.setItem("wishlist",JSON.stringify(t.wishlist.movie_tv)),g(m.fo.setInitialValue({type:"wishlist",value:t.wishlist.movie_tv}))}o(),w()}catch(e){console.error(e),d.oR.error("An error occurred. Please try again.")}},children:"Yes"}),(0,f.jsx)("button",{className:p,onClick:w,children:"No"})]})]}),document.getElementById("modal"))})),w="Wishlist_wishlist__WLOVE",y="Wishlist_wishlistItem__fzvlZ",I="Wishlist_type__uhz7I",N="Wishlist_title__mRJ3E",j="Wishlist_price__TIEhg",x="Wishlist_actions__VyibM",S="Wishlist_icon__4cB7K",k="Wishlist_emptyMessage__hqYJV",W="Wishlist_wishlistContainer__GqrN4",C="Wishlist_header__QYFaJ",b="Wishlist_refreshButton__DPGS2",R=()=>{const e=Number(JSON.parse(localStorage.getItem("userinfo")).id),t=localStorage.getItem("token"),[s,c]=(0,a.useState)(null),[h,d]=(0,a.useState)(""),[m,u]=(0,a.useState)(JSON.parse(localStorage.getItem("wishlist"))||[]),_=(0,a.useRef)(),v=()=>{const e=JSON.parse(localStorage.getItem("wishlist"))||[];u(e)},p={hidden:{opacity:0,x:50},visible:e=>({opacity:1,x:0,transition:{delay:.2*e,type:"spring",stiffness:100}})};return(0,f.jsxs)("div",{className:W,children:[(0,f.jsx)("div",{className:C,children:(0,f.jsxs)("button",{className:b,onClick:v,children:[(0,f.jsx)(o.JbZ,{})," Refresh"]})}),0===m.length?(0,f.jsx)("div",{className:k,children:"Wishlist is empty! Please add something!"}):(0,f.jsx)("div",{className:w,children:m.map(((e,t)=>(0,f.jsxs)(i.P.div,{className:y,custom:t,initial:"hidden",animate:"visible",variants:p,children:[(0,f.jsx)("div",{className:I,children:e.type.toUpperCase()}),(0,f.jsx)("div",{className:N,children:e.title}),(0,f.jsxs)("div",{className:j,children:[(0,f.jsx)(n.h4P,{}),e.price]}),(0,f.jsxs)("div",{className:x,children:[(0,f.jsx)(l.qxo,{className:S,onClick:()=>(e=>{c(e),d("cart"),_.current&&_.current.open()})(e)}),(0,f.jsx)(r.kgr,{className:S,onClick:()=>(e=>{c(e),d("delete"),_.current&&_.current.open()})(e)})]})]},e.id)))}),(0,f.jsx)(g,{ref:_,item:s,userId:e,token:t,onWishlistUpdate:v,actionType:h})]})}}}]);
//# sourceMappingURL=205.16aa49c5.chunk.js.map