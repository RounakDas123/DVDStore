{"ast":null,"code":"import React,{forwardRef,useImperativeHandle,useRef}from\"react\";import{createPortal}from\"react-dom\";import{useDispatch}from\"react-redux\";import{toast}from\"react-toastify\";import{cardbuttonsActions,wishlistCartActions}from\"../../store/index\";import classes from\"./ConfirmationModal.module.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ConfirmationModal=/*#__PURE__*/forwardRef((_ref,ref)=>{let{item,userId,token,onWishlistUpdate,actionType}=_ref;const dialog=useRef();const dispatch=useDispatch();useImperativeHandle(ref,()=>({open(){if(dialog.current)dialog.current.showModal();},close(){if(dialog.current)dialog.current.close();}}));const closeModal=()=>{if(dialog.current)dialog.current.close();};const handleYes=async()=>{try{if(actionType===\"cart\"){const responseAdd=await fetch(`${process.env.REACT_APP_BACKEND_URL}/cart/add/${userId}`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${token}`},body:JSON.stringify({id:item.id,type:item.type,title:item.title,price:item.price,quantity:1})});const responseDataAdd=await responseAdd.json();if(!responseDataAdd.ok&&!responseDataAdd.cart){toast.error(responseDataAdd.message);return;}toast.success(responseDataAdd.message);// Remove from Wishlist API call\nconst responseRemove=await fetch(`${process.env.REACT_APP_BACKEND_URL}/wishlist/delete/${userId}/${item.id}`,{method:\"DELETE\",headers:{Authorization:`Bearer ${token}`}});const responseDataRemove=await responseRemove.json();if(!responseDataRemove.ok&&!responseDataRemove.removedItem){toast.error(responseDataRemove.message);return;}toast.success(responseDataRemove.message);let size=0;size=responseDataAdd.cart.movie_tv.reduce((sum,item)=>sum+item.quantity,0);localStorage.setItem(\"cartSize\",size);dispatch(cardbuttonsActions.setInitialValue({type:\"cart\",value:size}));localStorage.setItem(\"cart\",JSON.stringify(responseDataAdd.cart.movie_tv));dispatch(wishlistCartActions.setInitialValue({type:\"cart\",value:responseDataAdd.cart.movie_tv}));localStorage.setItem(\"wishlistSize\",responseDataRemove.wishlist.movie_tv.length);dispatch(cardbuttonsActions.setInitialValue({type:\"wishlist\",value:responseDataRemove.wishlist.movie_tv.length}));localStorage.setItem(\"wishlist\",JSON.stringify(responseDataRemove.wishlist.movie_tv));dispatch(wishlistCartActions.setInitialValue({type:\"wishlist\",value:responseDataRemove.wishlist.movie_tv}));}else if(actionType===\"delete\"){const response_remove=await fetch(`${process.env.REACT_APP_BACKEND_URL}/wishlist/delete/${userId}/${item.id}`,{method:\"DELETE\",headers:{Authorization:\"Bearer \"+token}});const responseData_remove=await response_remove.json();if(!responseData_remove.ok&&!responseData_remove.removedItem){toast.error(responseData_remove.message);return;}toast.success(responseData_remove.message);localStorage.setItem(\"wishlistSize\",responseData_remove.wishlist.movie_tv.length);dispatch(cardbuttonsActions.setInitialValue({type:\"wishlist\",value:responseData_remove.wishlist.movie_tv.length}));localStorage.setItem(\"wishlist\",JSON.stringify(responseData_remove.wishlist.movie_tv));dispatch(wishlistCartActions.setInitialValue({type:\"wishlist\",value:responseData_remove.wishlist.movie_tv}));}onWishlistUpdate();closeModal();}catch(err){console.error(err);toast.error(\"An error occurred. Please try again.\");}};const modalMessage=actionType===\"cart\"?\"If you add to Cart, it will be removed from Wishlist. Do you wish to proceed?\":\"Do you wish to delete from Wishlist?\";return/*#__PURE__*/createPortal(/*#__PURE__*/_jsxs(\"dialog\",{ref:dialog,className:classes.modal,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Confirmation\"}),/*#__PURE__*/_jsx(\"p\",{children:modalMessage}),/*#__PURE__*/_jsxs(\"div\",{className:classes.buttonGroup,children:[/*#__PURE__*/_jsx(\"button\",{className:classes.yesButton,onClick:handleYes,children:\"Yes\"}),/*#__PURE__*/_jsx(\"button\",{className:classes.noButton,onClick:closeModal,children:\"No\"})]})]}),document.getElementById(\"modal\"));});export default ConfirmationModal;","map":{"version":3,"names":["React","forwardRef","useImperativeHandle","useRef","createPortal","useDispatch","toast","cardbuttonsActions","wishlistCartActions","classes","jsx","_jsx","jsxs","_jsxs","ConfirmationModal","_ref","ref","item","userId","token","onWishlistUpdate","actionType","dialog","dispatch","open","current","showModal","close","closeModal","handleYes","responseAdd","fetch","process","env","REACT_APP_BACKEND_URL","method","headers","Authorization","body","JSON","stringify","id","type","title","price","quantity","responseDataAdd","json","ok","cart","error","message","success","responseRemove","responseDataRemove","removedItem","size","movie_tv","reduce","sum","localStorage","setItem","setInitialValue","value","wishlist","length","response_remove","responseData_remove","err","console","modalMessage","className","modal","children","buttonGroup","yesButton","onClick","noButton","document","getElementById"],"sources":["C:/Users/dasru/Documents/DVDStore_dev/frontend/src/wishlist/components/ConfirmationModal.js"],"sourcesContent":["import React, { forwardRef, useImperativeHandle, useRef } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nimport { cardbuttonsActions, wishlistCartActions } from \"../../store/index\";\r\nimport classes from \"./ConfirmationModal.module.css\";\r\n\r\nconst ConfirmationModal = forwardRef(\r\n  ({ item, userId, token, onWishlistUpdate, actionType }, ref) => {\r\n    const dialog = useRef();\r\n    const dispatch = useDispatch();\r\n    useImperativeHandle(ref, () => ({\r\n      open() {\r\n        if (dialog.current) dialog.current.showModal();\r\n      },\r\n      close() {\r\n        if (dialog.current) dialog.current.close();\r\n      },\r\n    }));\r\n\r\n    const closeModal = () => {\r\n      if (dialog.current) dialog.current.close();\r\n    };\r\n\r\n    const handleYes = async () => {\r\n      try {\r\n        if (actionType === \"cart\") {\r\n          const responseAdd = await fetch(\r\n            `${process.env.REACT_APP_BACKEND_URL}/cart/add/${userId}`,\r\n            {\r\n              method: \"POST\",\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n                Authorization: `Bearer ${token}`,\r\n              },\r\n              body: JSON.stringify({\r\n                id: item.id,\r\n                type: item.type,\r\n                title: item.title,\r\n                price: item.price,\r\n                quantity: 1,\r\n              }),\r\n            }\r\n          );\r\n          const responseDataAdd = await responseAdd.json();\r\n          if (!responseDataAdd.ok && !responseDataAdd.cart) {\r\n            toast.error(responseDataAdd.message);\r\n            return;\r\n          }\r\n          toast.success(responseDataAdd.message);\r\n\r\n          // Remove from Wishlist API call\r\n          const responseRemove = await fetch(\r\n            `${process.env.REACT_APP_BACKEND_URL}/wishlist/delete/${userId}/${item.id}`,\r\n            {\r\n              method: \"DELETE\",\r\n              headers: {\r\n                Authorization: `Bearer ${token}`,\r\n              },\r\n            }\r\n          );\r\n          const responseDataRemove = await responseRemove.json();\r\n          if (!responseDataRemove.ok && !responseDataRemove.removedItem) {\r\n            toast.error(responseDataRemove.message);\r\n            return;\r\n          }\r\n          toast.success(responseDataRemove.message);\r\n\r\n          let size = 0;\r\n          size = responseDataAdd.cart.movie_tv.reduce(\r\n            (sum, item) => sum + item.quantity,\r\n            0\r\n          );\r\n\r\n          localStorage.setItem(\"cartSize\", size);\r\n          dispatch(\r\n            cardbuttonsActions.setInitialValue({ type: \"cart\", value: size })\r\n          );\r\n\r\n          localStorage.setItem(\r\n            \"cart\",\r\n            JSON.stringify(responseDataAdd.cart.movie_tv)\r\n          );\r\n          dispatch(\r\n            wishlistCartActions.setInitialValue({\r\n              type: \"cart\",\r\n              value: responseDataAdd.cart.movie_tv,\r\n            })\r\n          );\r\n\r\n          localStorage.setItem(\r\n            \"wishlistSize\",\r\n            responseDataRemove.wishlist.movie_tv.length\r\n          );\r\n          dispatch(\r\n            cardbuttonsActions.setInitialValue({\r\n              type: \"wishlist\",\r\n              value: responseDataRemove.wishlist.movie_tv.length,\r\n            })\r\n          );\r\n\r\n          localStorage.setItem(\r\n            \"wishlist\",\r\n            JSON.stringify(responseDataRemove.wishlist.movie_tv)\r\n          );\r\n          dispatch(\r\n            wishlistCartActions.setInitialValue({\r\n              type: \"wishlist\",\r\n              value: responseDataRemove.wishlist.movie_tv,\r\n            })\r\n          );\r\n        } else if (actionType === \"delete\") {\r\n          const response_remove = await fetch(\r\n            `${process.env.REACT_APP_BACKEND_URL}/wishlist/delete/${userId}/${item.id}`,\r\n            {\r\n              method: \"DELETE\",\r\n              headers: {\r\n                Authorization: \"Bearer \" + token,\r\n              },\r\n            }\r\n          );\r\n          const responseData_remove = await response_remove.json();\r\n          if (!responseData_remove.ok && !responseData_remove.removedItem) {\r\n            toast.error(responseData_remove.message);\r\n            return;\r\n          }\r\n          toast.success(responseData_remove.message);\r\n\r\n          localStorage.setItem(\r\n            \"wishlistSize\",\r\n            responseData_remove.wishlist.movie_tv.length\r\n          );\r\n          dispatch(\r\n            cardbuttonsActions.setInitialValue({\r\n              type: \"wishlist\",\r\n              value: responseData_remove.wishlist.movie_tv.length,\r\n            })\r\n          );\r\n\r\n          localStorage.setItem(\r\n            \"wishlist\",\r\n            JSON.stringify(responseData_remove.wishlist.movie_tv)\r\n          );\r\n          dispatch(\r\n            wishlistCartActions.setInitialValue({\r\n              type: \"wishlist\",\r\n              value: responseData_remove.wishlist.movie_tv,\r\n            })\r\n          );\r\n        }\r\n\r\n        onWishlistUpdate();\r\n        closeModal();\r\n      } catch (err) {\r\n        console.error(err);\r\n        toast.error(\"An error occurred. Please try again.\");\r\n      }\r\n    };\r\n    const modalMessage =\r\n      actionType === \"cart\"\r\n        ? \"If you add to Cart, it will be removed from Wishlist. Do you wish to proceed?\"\r\n        : \"Do you wish to delete from Wishlist?\";\r\n\r\n    return createPortal(\r\n      <dialog ref={dialog} className={classes.modal}>\r\n        <h2>Confirmation</h2>\r\n        <p>{modalMessage}</p>\r\n        <div className={classes.buttonGroup}>\r\n          <button className={classes.yesButton} onClick={handleYes}>\r\n            Yes\r\n          </button>\r\n          <button className={classes.noButton} onClick={closeModal}>\r\n            No\r\n          </button>\r\n        </div>\r\n      </dialog>,\r\n      document.getElementById(\"modal\")\r\n    );\r\n  }\r\n);\r\n\r\nexport default ConfirmationModal;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}